
üåä Windsurf Rules ‚Äî Language Learning App

This file defines how coding agents must operate on this project.

Rules are split into:
	‚Ä¢	PART A ‚Äî Universal Rules (apply to all projects)
	‚Ä¢	PART B ‚Äî Project-Specific Rules (apply ONLY to this app)

Conflict resolution order
	1.	/docs/contract.md wins
	2.	Universal rules override project-specific rules
	3.	Project-specific rules override agent suggestions

Failure to follow these rules invalidates a claim of ‚Äúdone‚Äù.

‚∏ª

PART A ‚Äî UNIVERSAL RULES

(Apply to ALL projects)

‚∏ª

Read These First (Every Chat)

Agents must acknowledge they have read:
	1.	/docs/contract.md
	2.	.windsurfrules.md (this file)

Acknowledgment must happen before proposing changes.

‚∏ª

Gated Execution Model (MANDATORY)

Work must follow explicit phases, in order.

Rules:
	‚Ä¢	One phase at a time
	‚Ä¢	Each phase has a gate
	‚Ä¢	If a gate fails, fix it before proceeding
	‚Ä¢	No ‚Äúdecision point‚Äù questions unless explicitly requested
	‚Ä¢	No claiming progress beyond the current phase

Forbidden:
	‚Ä¢	Skipping phases
	‚Ä¢	Bundling unrelated fixes
	‚Ä¢	Declaring readiness without passing gates

‚∏ª

Definition of Done (NON-NEGOTIABLE)

An agent may claim DONE only when all of the following are true:

Code Quality
	‚Ä¢	npm run test:run ‚Üí PASS
	‚Ä¢	npm run build ‚Üí PASS
	‚Ä¢	npm run lint ‚Üí PASS (non-blocking markdown warnings allowed)

Runtime Validation
	‚Ä¢	Zero console errors during normal flows
	‚Ä¢	No runtime warnings caused by agent changes

Manual Browser Validation (REQUIRED)

Agent must personally validate and provide screenshots for:
	‚Ä¢	Home
	‚Ä¢	Lessons
	‚Ä¢	Lookup (Arabic)
	‚Ä¢	Lookup (Spanish)
	‚Ä¢	Vocabulary landing
	‚Ä¢	Exercise detail

Reporting

Agent must provide:
	‚Ä¢	List of files changed
	‚Ä¢	Mapping of changes ‚Üí phase(s)
	‚Ä¢	Notes on any deferred work

If any item above is missing ‚Üí NOT DONE.

‚∏ª

Mobile-First Development (CRITICAL)

Test every change at these breakpoints in order:
	1.	375px ‚Äî phone baseline (must work FIRST)
	2.	768px ‚Äî tablet
	3.	1024px ‚Äî desktop

Rules:
	‚Ä¢	Touch targets ‚â• 48√ó48px
	‚Ä¢	Primary actions ‚â• 56√ó56px
	‚Ä¢	No hover-only interactions

‚∏ª

TypeScript Rules (No Exceptions)
	‚Ä¢	‚ùå No any
	‚Ä¢	unknown only with explicit narrowing
	‚Ä¢	Define interfaces/types for:
	‚Ä¢	persisted data
	‚Ä¢	cross-component props
	‚Ä¢	Props interfaces go above components
	‚Ä¢	Domain types live outside UI folders

‚∏ª

React Patterns (Mandatory)
	‚Ä¢	Navigation: useNavigate() only
‚ùå Never window.location.href
	‚Ä¢	Auth: onAuthStateChange listener
‚ùå Not one-time getUser()
	‚Ä¢	Async operations must expose:
	‚Ä¢	loading state
	‚Ä¢	error state
	‚Ä¢	Errors:
	‚Ä¢	user-friendly UI messages
	‚Ä¢	technical detail in console

‚∏ª

Refactor Safety (Universal)
	‚Ä¢	Never refactor behavior without locking it first
(tests, invariants, or explicit guarantees)
	‚Ä¢	One refactor goal per branch
	‚Ä¢	Preserve public APIs until all consumers migrate
	‚Ä¢	Prefer adapters over rewrites

Forbidden:
	‚Ä¢	Opportunistic cleanup
	‚Ä¢	Multi-concern PRs
	‚Ä¢	Silent behavior changes

‚∏ª

Before Saying ‚ÄúDone‚Äù (Universal Checklist)
	‚Ä¢	Breakpoints tested (375 / 768 / 1024)
	‚Ä¢	Zero console errors
	‚Ä¢	Loading + error states present
	‚Ä¢	No any
	‚Ä¢	Touch targets compliant
	‚Ä¢	Tests added or updated
	‚Ä¢	No undocumented behavior change

‚∏ª

PART B ‚Äî PROJECT-SPECIFIC RULES

(Language Learning App ONLY)

‚∏ª

Read These First (Every Chat)
	1.	/agents.md ‚Äî authoritative project instructions
	2.	/docs/architecture/dependency-map.md
	3.	/docs/architecture/data-models.md

If behavior contradicts documentation:
	‚Ä¢	Update the docs
	‚Ä¢	OR explicitly mark deprecated / planned

Silent drift is forbidden.

‚∏ª

Canonical Content Model (LOCKED)

The app supports exactly four content types, in this order:
	1.	word
	2.	sentence
	3.	dialog
	4.	passage

Rules:
	‚Ä¢	‚ùå ‚ÄúPhrase(s)‚Äù is forbidden ‚Äî use Sentence(s)
	‚Ä¢	Order is fixed everywhere (UI, APIs, storage, practice)
	‚Ä¢	Dialogs must be multi-turn (‚â•2 turns)
A single sentence shown as a dialog is a bug.

‚∏ª

Vocabulary System (AUTHORITATIVE)

‚ÄúMy Vocabulary‚Äù is a review hub, not a flat list.

Required structure:
	‚Ä¢	Landing page ‚Üí choose:
	‚Ä¢	Practice
	‚Ä¢	Archive
	‚Ä¢	Then choose content type:
	‚Ä¢	Words
	‚Ä¢	Sentences
	‚Ä¢	Dialogs
	‚Ä¢	Passages
	‚Ä¢	Then list items

Rules:
	‚Ä¢	Vocabulary counts must be language-scoped
	‚Ä¢	Practice flow must allow continuing to next item
	‚Ä¢	Saving an item must not dead-end the user

‚∏ª

Language-Scoped Data (INVARIANT)

All of the following must be scoped by active language:
	‚Ä¢	counts
	‚Ä¢	feeds
	‚Ä¢	lesson libraries
	‚Ä¢	saved vocabulary
	‚Ä¢	practice queues
	‚Ä¢	archives

Rules:
	‚Ä¢	No cross-language leakage
	‚Ä¢	Switching language must immediately update all derived state
	‚Ä¢	Dependency arrays must include language

‚∏ª

Language & Modality Awareness

All shared logic must assume:
	‚Ä¢	multiple languages
	‚Ä¢	non-Latin scripts
	‚Ä¢	LTR and RTL layouts
	‚Ä¢	text + voice (future)

Therefore:
	‚Ä¢	Language must be explicit in data models
	‚Ä¢	Validation must be semantic
	‚Ä¢	UI must not assume keyboard, Latin script, or LTR

‚∏ª

Added Context Tile (REQUIRED)

An Added Context tile must exist in:
	‚Ä¢	Lookup results
	‚Ä¢	Lesson word detail
	‚Ä¢	Exercise word detail

Content rules:
	‚Ä¢	Arabic
	‚Ä¢	root / morphology
	‚Ä¢	dialect vs MSA usage
	‚Ä¢	Spanish
	‚Ä¢	base form / conjugation (if verb)
	‚Ä¢	LatAm vs Spain usage

Rules:
	‚Ä¢	Must be language-aware
	‚Ä¢	Must degrade gracefully
	‚Ä¢	Must never crash on missing data

‚∏ª

Arabic-Only Features (STRICTLY GATED)

Only show when language === 'arabic':
	‚Ä¢	Letter breakdown
	‚Ä¢	Hebrew cognates
	‚Ä¢	Egyptian/MSA toggles

Forbidden:
	‚Ä¢	Rendering empty placeholders in Spanish
	‚Ä¢	Executing Arabic logic in Spanish paths

‚∏ª

Theme Invariant (CRITICAL)

Home defines the canonical visual language.

Rules:
	‚Ä¢	Card radius, borders, shadows, background, padding are canonical
	‚Ä¢	Lessons, Lookup, Vocabulary, Exercises must reuse the same base tokens
	‚Ä¢	‚ùå Black/white ‚Äúutility‚Äù surfaces for primary content are forbidden
	‚Ä¢	Accent colors may vary by language, not base surfaces

‚∏ª

Persistence Rules
	‚Ä¢	localStorage ‚Üí session recovery only
	‚Ä¢	Supabase ‚Üí long-term memory only

If a hook touches both:
	‚Ä¢	Document why
	‚Ä¢	Keep responsibilities separate

‚∏ª

Documentation Discipline

Any change affecting:
	‚Ä¢	learning flow
	‚Ä¢	saving behavior
	‚Ä¢	vocabulary structure
	‚Ä¢	language handling
	‚Ä¢	practice logic
	‚Ä¢	hooks

must update:
	‚Ä¢	README.md
	‚Ä¢	agents.md
	‚Ä¢	relevant /docs/architecture/*

Docs are treated as versioned system components.

‚∏ª

Project ‚ÄúDone‚Äù Checklist (ADDITIVE)
	‚Ä¢	Canonical content types respected everywhere
	‚Ä¢	Vocabulary flow works end-to-end
	‚Ä¢	No Arabic leakage into Spanish
	‚Ä¢	No language count mismatches
	‚Ä¢	Added Context tile present and correct
	‚Ä¢	Visual theme unified across views
	‚Ä¢	Browser-verified screenshots captured
	‚Ä¢	Verification note written

‚∏ª

This file is authoritative.
If an agent is unsure, it must stop and ask ‚Äî not guess.